<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resume Preview | Nexus CV</title>
  <meta name="description" content="Preview your AI-generated resume with ATS score breakdown before downloading.">
  <meta property="og:title" content="Resume Preview | Nexus CV">
  <meta property="og:description" content="Preview and download your ATS-optimized resume.">
  <meta property="og:image" content="/static/og-image.png">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="canonical" href="/resume-preview">
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml">
  <link rel="stylesheet" href="/static/style.css">
</head>

<body>
  <script src="/static/theme.js"></script>

  <!-- NAVBAR -->
  <nav class="navbar">
    <button onclick="toggleTheme()" class="btn outline">üåô</button>
    <div>
      <span class="brand-main">Resume</span><span class="brand-accent">IQ</span>
    </div>

    {% if session.get("user") %}
    <div class="profile">
      <div class="avatar" onclick="toggleMenu()">
        {{ session["user"][0]|upper }}
      </div>
      <div id="menu" class="menu">
        <a href="/">Home</a>
        <a href="/history">History</a>
        <a href="/upload-page">Upload Resume</a>
        <a href="/compare-resume">Compare Resumes</a>
        <a href="/resume-builder">Build Resume</a>
        <a href="/download-pdf">Download Report</a>
        <a href="/logout">Logout</a>
      </div>
    </div>
    {% else %}
    <div>
      <a href="/login" class="btn outline">Login</a>
      <a href="/register" class="btn">Register</a>
    </div>
    {% endif %}
  </nav>

  <div class="container">

    <h1 style="text-align:center;">Your Generated Resume</h1>

    <!-- ATS SCORE BADGE -->
    <div style="text-align:center; margin: 20px 0;">
      <div
        class="ats-badge {% if ats_score >= 90 %}badge-excellent{% elif ats_score >= 80 %}badge-good{% else %}badge-low{% endif %}">
        ATS Score: {{ ats_score }}%
      </div>
      <p style="opacity:0.7; margin-top:8px; font-size:14px;">
        Target Role: <strong>{{ target_role }}</strong>
      </p>
    </div>

    <!-- ATS BREAKDOWN -->
    <section class="card">
      <h3>üìä ATS Score Breakdown</h3>
      <p>‚úî <b>Skills Match:</b> {{ ats_result.skill_score }} / 50</p>
      <p>‚úî <b>Keyword Coverage:</b> {{ ats_result.keyword_score }} / 30</p>
      <p>‚úî <b>Resume Completeness:</b> {{ ats_result.completeness_score }} / 20</p>
    </section>

    <!-- RESUME PREVIEW (HTML) -->
    <section class="card resume-preview">

      <div class="preview-header">
        <h2 style="margin:0; text-align:center;">{{ resume.name }}</h2>
        <p class="preview-contact">
          {% if resume.email %}{{ resume.email }}{% endif %}
          {% if resume.phone %} | {{ resume.phone }}{% endif %}
          {% if resume.linkedin %} | {{ resume.linkedin }}{% endif %}
          {% if resume.github %} | {{ resume.github }}{% endif %}
          {% if resume.portfolio %} | {{ resume.portfolio }}{% endif %}
        </p>
      </div>

      {% if resume.career_objective %}
      <div class="preview-section">
        <h4 class="preview-heading">CAREER OBJECTIVE</h4>
        <p>{{ resume.career_objective }}</p>
      </div>
      {% endif %}

      {% if resume.education %}
      <div class="preview-section">
        <h4 class="preview-heading">EDUCATION</h4>
        {% for edu in resume.education %}
        <p><strong>{{ edu.degree }}</strong>
          {% if edu.institution %} ‚Äî {{ edu.institution }}{% endif %}
          {% if edu.year %} ({{ edu.year }}){% endif %}
        </p>
        {% endfor %}
      </div>
      {% endif %}

      {% if resume.experience %}
      <div class="preview-section">
        <h4 class="preview-heading">WORK EXPERIENCE</h4>
        {% for exp in resume.experience %}
        <p style="margin-bottom:4px;">
          <strong>{{ exp.title }}</strong>
          {% if exp.company %} | {{ exp.company }}{% endif %}
          {% if exp.duration %} ({{ exp.duration }}){% endif %}
        </p>
        <ul class="preview-bullets">
          {% for bullet in exp.bullets %}
          <li>{{ bullet }}</li>
          {% endfor %}
        </ul>
        {% endfor %}
      </div>
      {% endif %}

      {% if resume.projects %}
      <div class="preview-section">
        <h4 class="preview-heading">PROJECTS</h4>
        {% for proj in resume.projects %}
        <p style="margin-bottom:4px;">
          <strong>{{ proj.name }}</strong>
          {% if proj.tech %} | {{ proj.tech }}{% endif %}
        </p>
        <ul class="preview-bullets">
          {% for bullet in proj.bullets %}
          <li>{{ bullet }}</li>
          {% endfor %}
        </ul>
        {% endfor %}
      </div>
      {% endif %}

      {% if resume.skills_list %}
      <div class="preview-section">
        <h4 class="preview-heading">TECHNICAL SKILLS</h4>
        <p>{{ resume.skills_list | join(', ') }}</p>
      </div>
      {% endif %}

      {% if resume.certifications_list %}
      <div class="preview-section">
        <h4 class="preview-heading">CERTIFICATIONS</h4>
        <ul class="preview-bullets">
          {% for cert in resume.certifications_list %}
          <li>{{ cert }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

      {% if resume.achievements_list %}
      <div class="preview-section">
        <h4 class="preview-heading">ACHIEVEMENTS</h4>
        <ul class="preview-bullets">
          {% for ach in resume.achievements_list %}
          <li>{{ ach }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}

    </section>

    <!-- SKILLS INFO -->
    {% if ats_result.matched_skills %}
    <section class="card">
      <h3>‚úÖ Matched Skills</h3>
      <p>
        {% for skill in ats_result.matched_skills %}
        <span class="skill-tag skill-matched">{{ skill }}</span>
        {% endfor %}
      </p>
    </section>
    {% endif %}

    {% if ats_result.missing_skills %}
    <section class="card">
      <h3>‚ö†Ô∏è Skills Not Covered</h3>
      <p>
        {% for skill in ats_result.missing_skills %}
        <span class="skill-tag skill-missing">{{ skill }}</span>
        {% endfor %}
      </p>
    </section>
    {% endif %}

    <!-- ACTION BUTTONS -->
    <div style="text-align:center; margin: 30px 0 60px;">
      <a href="/download-resume" class="btn large">üì• Download PDF</a>
      <a href="/edit-resume" class="btn large outline">‚úèÔ∏è Edit Details</a>
    </div>

  </div>

</body>

</html>