<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Resume Analysis History | Nexus CV</title>
    <meta name="description"
        content="View your past resume analysis results, ATS scores, and download previous reports.">
    <meta property="og:title" content="Analysis History | Nexus CV">
    <meta property="og:description" content="Track your resume improvement over time.">
    <meta property="og:image" content="/static/og-image.png">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="canonical" href="/history">
    <link rel="icon" href="/static/favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="/static/style.css">
</head>

<body>
    <script src="/static/theme.js"></script>

    <nav class="navbar">
        <button onclick="toggleTheme()" class="btn outline">ðŸŒ™</button>
        <div></div>
        {% if session.get("user") %}
        <div class="profile">
            <div class="avatar" onclick="toggleMenu()">
                {{ session["user"][0]|upper }}
            </div>
            <div id="menu" class="menu">
                <a href="/">Home</a>
                <a href="/history" class="active">History</a>
                <a href="/upload-page">Upload Resume</a>
                <a href="/compare-resume">Compare Resumes</a>
                <a href="/resume-builder">Build Resume</a>
                <a href="/logout">Logout</a>
            </div>
        </div>
        {% else %}
        <div>
            <a href="/login" class="btn outline">Login</a>
            <a href="/register" class="btn">Register</a>
        </div>
        {% endif %}
    </nav>

    <div class="container">
        <h2>Your Resume Analysis History</h2>

        {% if records %}
        <div class="card">
            <table style="width:100%; border-collapse: collapse;">
                <tr>
                    <th style="text-align:left; padding:10px;">Role</th>
                    <th style="text-align:left; padding:10px;">ATS Score</th>
                    <th style="text-align:left; padding:10px;">Date</th>
                    <th style="text-align:left; padding:10px;">Report</th>
                </tr>

                {% for r in records %}
                <tr>
                    <td style="padding:10px;">{{ r[0] }}</td>
                    <td style="padding:10px;">{{ r[1] }}%</td>
                    <td style="padding:10px;">{{ r[2] }}</td>
                    <td style="padding:10px;">
                        {% if r[3] %}
                        <a href="/download-history-pdf?path={{ r[3] }}" class="btn small">
                            Download PDF
                        </a>
                        {% else %}
                        â€”
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>
        {% else %}
        <div class="card">
            <p>No analysis history found. Start by analyzing a resume!</p>
        </div>
        {% endif %}

        <div style="margin-top:30px; text-align:center;">
            <a href="/upload-page" class="btn">Analyze Another Resume</a>
            <a href="/" class="btn outline">Home</a>
        </div>
    </div>

</body>

</html>